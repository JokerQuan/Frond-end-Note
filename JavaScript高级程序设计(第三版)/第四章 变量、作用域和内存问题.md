# 第四章 变量、作用域和内存问题

## 基本类型和引用类型的值

很多语言中，字符串以对象形式表示，是引用类型，但 **在JavaScript中，string是基本类型**。

### 类型检测

- 基本数据类型用typeof操作符即可
- instanceof，变量是否是给定引用类型（根据原型链识别，第六章）的实例



## 执行环境及作用域

​		每个执行环境都有一个与之关联的变量对象，环境中定义的所有变量和函数都保存在这个对象中。

​		web浏览器中，全局执行环境被认为是window对象。

​		每个函数都有自己的执行环境，执行流进入一个函数时，函数的环境会被推入一个环境栈中。函数执行之后，栈将其环境弹出，把控制权返回给之前的执行环境。

​		代码在一个环境中执行时，会创建变量对象的一个作用域链。



## 垃圾收集

​		垃圾收集器按照固定的时间间隔，或代码执行中预订的收集时间，周期性地找出不再继续使用的变量，释放内存。具体到浏览器中的实现，通常有两个策略

### 标记清除

​		变量进入环境（例如，在函数中声明变量）时，标记为“进入环境”，离开环境时，标记为“离开环境”。

### 引用计数

​		引用计数存在循环引用的问题，IE的BOM、DOM使用C++以COM对象的形式实现，COM使用的是引用计数，可以用手动断开引用的方式避免，如 obj.property = null，IE9把BOM、DOM转换为真正的JavaScript对象，避免了该问题。
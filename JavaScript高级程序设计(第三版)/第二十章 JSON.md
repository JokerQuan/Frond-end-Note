# 第二十章 JSON

## 语法

### 简单值

- 数字
- 字符串，只能使用双引号，不能使用单引号
- 布尔值
- null

### 对象

​		与 JavaScript 中对象的字面量一致，但 JSON 的属性名必须加上双引号。

### 数组

​		与 JavaScript 中数组的字面量一致。



## 解析与序列化

### JSON 对象

​		早期 JSON 解析器基本上就是使用 eval() 函数。

​		为了安全考虑，兼容早期浏览器最好使用 shim 的 JSON-js。

​		HTML5 对解析 JSON 的行为进行规范，定义了全局对象 JSON，有两个方法：

- stringify()，将 JavaScript 对象序列化为 JSON 字符串。序列化时，函数、原型成员、值为 undefined 的属性都会被跳过。
- parse()，将 JSON 字符串解析为原生 JavaScript 值。

### 序列化选项

​		JSON.stringify() 还有两个参数，依次为：

- 过滤器
    - 数组，结果中只包含数组中列出的属性。
    - 函数，函数有两个参数，key（属性名）、属性值，返回对应属性名被处理后的属性值。返回 undefined 时，该属性会被忽略。
- 缩进选项，传入数值，表示每个级别缩进的空格数。数值有效，则会自动插入换行符。最大值为  10，超过10会按10来缩进。

​         有时候 JSON.stringify() 方法还是不能满足自定义序列化的需求，这时可以为对象定义 toJSON() 方法。toJSON() 方法可以作为函数过滤器的补充，JSON.stringify() 的序列化顺序如下：

1. 如果存在 toJSON 方法且能够通过它取得有效值，则调用该方法，否则返回对象本身。
2. 如果提供了第二个参数，应用该函数过滤器，传入函数过滤器的值是第一步的结果。
3. 对第二步返回的每个值进行相应的序列化。
4. 如果提供了第三个参数，则进行相应的缩进格式化。

### 解析选项

​		JSON.parse() 还可接收一个参数：

- 还原函数，解析时在每个键值对上调用，参数为 key、value，返回经过处理的 value，体现在解析结果中。若返回 undefined，则该属性在结果中去除。